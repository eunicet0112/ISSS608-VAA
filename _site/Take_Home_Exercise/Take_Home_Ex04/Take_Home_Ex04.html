<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eunice Taam">
<meta name="dcterms.date" content="2024-03-05">

<title>ISSS608-VAA - Prototyping Modules for Visual Analytics Shiny Application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-Class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In_Class_Exercise/In_Class_Ex01/In_Class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-On Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands_On_Exercise/Hands_On_Ex01/Hands_On_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Exercise/Hands_On_Ex02/Hands_On_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Exercise/Hands_On_Ex03A/Hands_On_Ex03A.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 3A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Exercise/Hands_On_Ex03B/Hands_On_Ex03B.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 3B</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-Home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take_Home_Exercise/Take_Home_Ex01/Take_Home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_Home_Exercise/Take_Home_Ex02/Take_Home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_Home_Exercise/Take_Home_Ex03/Take_Home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_Home_Exercise/Take_Home_Ex04/Take_Home_Ex04.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1.0 Overview</a></li>
  <li><a href="#importing-relevant-r-packages" id="toc-importing-relevant-r-packages" class="nav-link" data-scroll-target="#importing-relevant-r-packages">2.0 Importing Relevant R Packages</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">3.0 Data Preparation</a>
  <ul class="collapse">
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data">3.1 Importing Data</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">3.2 Data Cleaning</a></li>
  </ul></li>
  <li><a href="#data-visualisation" id="toc-data-visualisation" class="nav-link" data-scroll-target="#data-visualisation">4.0 Data Visualisation</a>
  <ul class="collapse">
  <li><a href="#overview-of-historical-daily-weather-data" id="toc-overview-of-historical-daily-weather-data" class="nav-link" data-scroll-target="#overview-of-historical-daily-weather-data">4.1 Overview of Historical Daily Weather Data</a></li>
  <li><a href="#geographical-overview-of-historical-daily-weather-data" id="toc-geographical-overview-of-historical-daily-weather-data" class="nav-link" data-scroll-target="#geographical-overview-of-historical-daily-weather-data">4.2 Geographical Overview of Historical Daily Weather Data</a></li>
  </ul></li>
  <li><a href="#user-interface-ui-design-of-shiny-application" id="toc-user-interface-ui-design-of-shiny-application" class="nav-link" data-scroll-target="#user-interface-ui-design-of-shiny-application">5.0 User-Interface (UI) Design of Shiny Application</a>
  <ul class="collapse">
  <li><a href="#storyboard-of-shiny-application" id="toc-storyboard-of-shiny-application" class="nav-link" data-scroll-target="#storyboard-of-shiny-application">5.1 Storyboard of Shiny Application</a></li>
  <li><a href="#user-specified-parameters-of-shiny-application" id="toc-user-specified-parameters-of-shiny-application" class="nav-link" data-scroll-target="#user-specified-parameters-of-shiny-application">5.2 User-Specified Parameters of Shiny Application</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Prototyping Modules for Visual Analytics Shiny Application</h1>
<p class="subtitle lead">In this exercise, we will be developing one of the modules in our proposed Shiny application.</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Eunice Taam </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 5, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">1.0 Overview</h2>
<p>Prototyping plays a pivotal role in the development of applications, serving as a foundation step that can significantly impact the success of the final product. By creating prototypes, we can visualise and refine our ideas, and identify potential flaws early. Prototyping can thus help mitigate risks, save time and resources and ensure that the final application aligns with the intended goals and requirements.</p>
<p>In this exercise, we will be developing the prototype for our Visual Analytics Shiny Application on Singapore’s climate. Specifically, we will be focusing on the prototype for the <strong>Historical Analysis</strong> module. This module seeks to visualise Singapore’s historical climate data (including rainfall, temperature and wind speed) through two tabs - Overview and Geographical.</p>
</section>
<section id="importing-relevant-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="importing-relevant-r-packages">2.0 Importing Relevant R Packages</h2>
<p>The relevant R packages to be used are as follows:</p>
<ul>
<li><p>dplyr - for manipulating data</p></li>
<li><p>tidyverse - for tidying data</p></li>
<li><p>ggplot2 - for creating plots from data</p></li>
<li><p>plotly - for introducing interactivity into ggplot2 figures</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, tidyverse, fuzzyjoin,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggplot2, plotly, tmap, leaflet, RColorBrewer, htmltools, gganimate, gifski)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">3.0 Data Preparation</h2>
<section id="importing-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-data">3.1 Importing Data</h3>
<p>Historical daily weather data was retrieved from the <a href="http://www.weather.gov.sg/climate-historical-daily/">Meteological Service Singapore</a>. It consists of data from January 2014 to December 2023 across 12 weather stations. The time period and weather stations were chosen to ensure completeness of the data across all attributes by referencing the <a href="http://www.weather.gov.sg/wp-content/uploads/2022/06/Station_Records.pdf">station records</a> provided by MSS.</p>
<p>The code chunk below downloads the weather data files for the chosen weather stations (<code>S</code> values) and time (<code>yyyymm</code> values) by fitting the two values into the base URL of ‘http://www.weather.gov.sg/files/dailydata/DAILYDATA_’. The <code>tryCatch()</code> function is used to handle errors that may occur during the download process. Specifically, if the file for certain combinations of weather stations and year is not found, it prints a message indicating that the file was not found and continues to the next file.</p>
<div class="cell">
<details>
<summary>Code to scrape data from chosen weather stations from Jan 2014 to Dec 2023</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the base URL</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"http://www.weather.gov.sg/files/dailydata/DAILYDATA_"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the range of S values (weather stations)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>s_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S24"</span>, <span class="st">"S50"</span>, <span class="st">"S60"</span>, <span class="st">"S107"</span>, <span class="st">"S111"</span>, <span class="st">"S116"</span>, <span class="st">"S121"</span>, <span class="st">"S43"</span>, <span class="st">"S109"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"S104"</span>, <span class="st">"S106"</span>, <span class="st">"S107"</span>, <span class="st">"S115"</span>, <span class="st">"S117"</span>)  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the range of yyyymm values (from 201401 to 202312)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>yyyymm_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"201401"</span>, <span class="st">"201402"</span>, <span class="st">"201403"</span>, <span class="st">"201404"</span>, <span class="st">"201405"</span>, <span class="st">"201406"</span>, <span class="st">"201407"</span>, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201408"</span>, <span class="st">"201409"</span>, <span class="st">"201410"</span>, <span class="st">"201411"</span>, <span class="st">"201412"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201501"</span>, <span class="st">"201502"</span>, <span class="st">"201503"</span>, <span class="st">"201504"</span>, <span class="st">"201505"</span>, <span class="st">"201506"</span>, <span class="st">"201507"</span>, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201508"</span>, <span class="st">"201509"</span>, <span class="st">"201510"</span>, <span class="st">"201511"</span>, <span class="st">"201512"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201601"</span>, <span class="st">"201602"</span>, <span class="st">"201603"</span>, <span class="st">"201604"</span>, <span class="st">"201605"</span>, <span class="st">"201606"</span>, <span class="st">"201607"</span>, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201608"</span>, <span class="st">"201609"</span>, <span class="st">"201610"</span>, <span class="st">"201611"</span>, <span class="st">"201612"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201701"</span>, <span class="st">"201702"</span>, <span class="st">"201703"</span>, <span class="st">"201704"</span>, <span class="st">"201705"</span>, <span class="st">"201706"</span>, <span class="st">"201707"</span>, </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201708"</span>, <span class="st">"201709"</span>, <span class="st">"201710"</span>, <span class="st">"201711"</span>, <span class="st">"201712"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201801"</span>, <span class="st">"201802"</span>, <span class="st">"201803"</span>, <span class="st">"201804"</span>, <span class="st">"201805"</span>, <span class="st">"201806"</span>, <span class="st">"201807"</span>, </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201808"</span>, <span class="st">"201809"</span>, <span class="st">"201810"</span>, <span class="st">"201811"</span>, <span class="st">"201812"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201901"</span>, <span class="st">"201902"</span>, <span class="st">"201903"</span>, <span class="st">"201904"</span>, <span class="st">"201905"</span>, <span class="st">"201906"</span>, <span class="st">"201907"</span>, </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"201908"</span>, <span class="st">"201909"</span>, <span class="st">"201910"</span>, <span class="st">"201911"</span>, <span class="st">"201912"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"202001"</span>, <span class="st">"202002"</span>, <span class="st">"202003"</span>, <span class="st">"202004"</span>, <span class="st">"202005"</span>, <span class="st">"202006"</span>, <span class="st">"202007"</span>, </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"202008"</span>, <span class="st">"202009"</span>, <span class="st">"202010"</span>, <span class="st">"202011"</span>, <span class="st">"202012"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"202101"</span>, <span class="st">"202102"</span>, <span class="st">"202103"</span>, <span class="st">"202104"</span>, <span class="st">"202105"</span>, <span class="st">"202106"</span>, <span class="st">"202107"</span>, </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"202108"</span>, <span class="st">"202109"</span>, <span class="st">"202110"</span>, <span class="st">"202111"</span>, <span class="st">"202112"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"202201"</span>, <span class="st">"202202"</span>, <span class="st">"202203"</span>, <span class="st">"202204"</span>, <span class="st">"202205"</span>, <span class="st">"202206"</span>, <span class="st">"202207"</span>, </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"202208"</span>, <span class="st">"202209"</span>, <span class="st">"202210"</span>, <span class="st">"202211"</span>, <span class="st">"202212"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"202301"</span>, <span class="st">"202302"</span>, <span class="st">"202303"</span>, <span class="st">"202304"</span>, <span class="st">"202305"</span>, <span class="st">"202306"</span>, <span class="st">"202307"</span>, </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"202308"</span>, <span class="st">"202309"</span>, <span class="st">"202310"</span>, <span class="st">"202311"</span>, <span class="st">"202312"</span>) </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the folder to save the files</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">"Data/"</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each combination of s and yyyymm</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> s_values) {</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (yyyymm <span class="cf">in</span> yyyymm_values) {</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Construct the URL</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_url, s, <span class="st">"_"</span>, yyyymm, <span class="st">".csv"</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Construct the file name with folder path</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(folder, <span class="st">"DAILYDATA_"</span>, s, <span class="st">"_"</span>, yyyymm, <span class="st">".csv"</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Download the file with error handling</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">download.file</span>(url, <span class="at">destfile =</span> filename, <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Downloaded"</span>, filename, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"File not found:"</span>, filename, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below reads all the CSV files saved in the previous step and combines them into a single data frame <code>df</code>. The resultant dataframe was saved as an .rds file format using <code>write_rds()</code>.</p>
<div class="cell">
<details>
<summary>Code to combine datasets into one</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of files in the directory</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>file_list <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">"Data/WeatherData"</span>, <span class="at">pattern=</span><span class="st">".csv"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store preprocessed data frames</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>preprocessed_data_frames <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each file</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (file <span class="cf">in</span> file_list) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read the file and remove header row</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file, <span class="fu">locale</span>(<span class="at">encoding=</span><span class="st">"UTF-8"</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace "\x97" (special character to indicate no measurements done) with NA </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data, <span class="cf">function</span>(x) <span class="fu">str_replace_all</span>(x, <span class="fu">fixed</span>(<span class="st">"</span><span class="sc">\x97</span><span class="st">"</span>), <span class="cn">NA</span>)))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace "ó" (special character to indicate no measurements done) with NA </span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data, <span class="cf">function</span>(x) <span class="fu">str_replace_all</span>(x, <span class="fu">fixed</span>(<span class="st">"ó"</span>), <span class="cn">NA</span>)))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace "-" (special character to indicate no measurements done) with NA </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data, <span class="cf">function</span>(x) <span class="fu">str_replace_all</span>(x, <span class="fu">fixed</span>(<span class="st">"-"</span>), <span class="cn">NA</span>)))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the preprocessed data frame in the list</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  preprocessed_data_frames[[<span class="fu">length</span>(preprocessed_data_frames) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> data</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure all data frames have the same column names and order</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, preprocessed_data_frames)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Naming columns</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Station"</span>, <span class="st">"Year"</span>, <span class="st">"Month"</span>, <span class="st">"Day"</span>, <span class="st">"Total Daily Rainfall"</span>, <span class="st">"Highest 30 Min Rainfall"</span>, <span class="st">"Highest 60 Min Rainfall"</span>, <span class="st">"Highest 120 Min Rainfall"</span>, <span class="st">"Mean Temperature"</span>, <span class="st">"Maximum Temperature"</span>, <span class="st">"Minimum Temperature"</span>, <span class="st">"Mean Wind Speed"</span>, <span class="st">"Max Wind Speed"</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Save combined_df as .rds file format</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(combined_df, <span class="st">"Data/combined_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>read_rds()</code> function was then used to read the R object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"Data/combined_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">3.2 Data Cleaning</h3>
<p>The following data cleaning steps were implemented on the data:</p>
<ul>
<li><p><strong>Handling Missing Values</strong>: Using <code>complete.cases()</code> to check the rows with complete data, there are 2599 rows with NA values. Since our data has over 47,000 records and incomplete rows form only about 5% of the data, we will drop the rows with NA values for simplicity.</p></li>
<li><p><strong>Dealing with Duplicates</strong>: <code>combined_df[duplicated(combined_df), ]</code> returned a data frame with zero rows, indicating that there are no duplicate rows. No further action was thus needed.</p></li>
<li><p><strong>Data Type Conversion</strong>: All columns are of character type. All columns except the ‘Station’ column was converted to its appropriate data type using <code>as.numeric()</code>.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code to clean data</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for NA records and dropping rows with NA records</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'There are '</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(df)), <span class="st">'rows with NA values'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>There are  2599 rows with NA values</code></pre>
</div>
<details>
<summary>Code to clean data</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for duplicate records</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df[duplicated(df), ]</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting all columns to numeric form except first</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>df[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[, <span class="sc">-</span><span class="dv">1</span>], as.numeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="data-visualisation" class="level2">
<h2 class="anchored" data-anchor-id="data-visualisation">4.0 Data Visualisation</h2>
<p>For simplicity, we will use <strong>yearly intervals</strong>, <strong>all regions</strong> and <strong>the whole period from 2014 to 2023</strong> for this section. The parameters of this visualisation to allow users to explore the data and customise the visualisation will be discussed later in Section 5.1.</p>
<section id="overview-of-historical-daily-weather-data" class="level3">
<h3 class="anchored" data-anchor-id="overview-of-historical-daily-weather-data">4.1 Overview of Historical Daily Weather Data</h3>
<p>In this section, we will be developing the prototype for an overview of the historical daily weather data.</p>
<div class="cell">
<details>
<summary>Code to process data for plotting</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting relevant columns</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Aggregating data using yearly intervals</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_temp =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Mean Temperature</span><span class="st">`</span>), </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_maxtemp =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Maximum Temperature</span><span class="st">`</span>), </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_mintemp =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Minimum Temperature</span><span class="st">`</span>), </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_rainfall =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Total Daily Rainfall</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Design Considerations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Colour Differentiation</strong>: Distinct colours were used for the bars and lines to differentiate between the various rainfall and temperature data for greater clarity.</p></li>
<li><p><strong>Visual Hierachy</strong>: More critical data points (temperature in this case) were emphasised by placing the temperature line plots above the rainfall bar charts. This helps viewers focus on the primary temperature information while still being able to interpret the secondary rainfall data.</p></li>
<li><p><strong>Axis Labels and Units</strong>: The x-axis and y-axis were clearly labelled with its corresponding units to facilitate understanding.</p></li>
<li><p><strong>Gridlines and Ticks</strong>: Vertical gridlines were retained to aid in interpretation and aligning data points. However, horizontal grid lines were removed as it clutters the chart and do not add significant value since the bars and line markers clearly denote the year to which the data point belong.</p></li>
<li><p><strong>Legend</strong>: A legend was included to explain the meaning of each element in the chart.</p></li>
</ul>
</div>
</div>
<div class="cell">
<details>
<summary>Code for plotting</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ly</span>(<span class="at">data=</span>df1, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="sc">~</span>Year, <span class="co"># Set x=Year for yearly intervals</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Plotting line charts for temperature data</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="sc">~</span>mean_temp, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">type=</span><span class="st">'scatter'</span>, <span class="at">mode=</span><span class="st">'lines+markers'</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">marker=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#008000"</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">line=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#008000"</span>, <span class="at">width=</span><span class="fl">1.5</span>)), </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">line=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#008000"</span>, <span class="at">width=</span><span class="fl">1.5</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">yaxis=</span><span class="st">"y"</span>, <span class="co"># Specifying which axis to use</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">name=</span><span class="st">"Mean Temperature"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(<span class="at">y=</span><span class="sc">~</span>mean_maxtemp, </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">type=</span><span class="st">'scatter'</span>, <span class="at">mode=</span><span class="st">'lines+markers'</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">marker=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#8B0000"</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">line=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#8B0000"</span>, <span class="at">width=</span><span class="fl">1.5</span>)), </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">line=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#8B0000"</span>, <span class="at">width=</span><span class="fl">1.5</span>),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">yaxis=</span><span class="st">"y"</span>, <span class="co"># Specifying which axis to use</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">name=</span><span class="st">"Maximum Temperature"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(<span class="at">y=</span><span class="sc">~</span>mean_mintemp, </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">type=</span><span class="st">'scatter'</span>, <span class="at">mode=</span><span class="st">'lines+markers'</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">marker=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#02367B"</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">line=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#02367B"</span>, <span class="at">width=</span><span class="fl">1.5</span>)), </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">line=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"#02367B"</span>, <span class="at">width=</span><span class="fl">1.5</span>),</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">yaxis=</span><span class="st">"y"</span>, <span class="co"># Specifying which axis to use</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">name=</span><span class="st">"Minimum Temperature"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">y=</span><span class="sc">~</span>mean_rainfall, </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">type=</span><span class="st">'bar'</span>, </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">marker=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">line=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">width=</span><span class="dv">1</span>)),</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">yaxis=</span><span class="st">"y2"</span>, <span class="co"># Specifying which axis to use</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">name=</span><span class="st">"Total Daily Rainfall"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="st">"Average Yearly Temperature and Rainfall Over the Years"</span>, </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Setting up x-axis </span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">"Year"</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tickmode=</span><span class="st">"linear"</span>), <span class="co"># Showing all tick marks</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Setting up primary y-axis</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">overlaying=</span><span class="st">"y2"</span>,  <span class="co"># Set line plots to overlay bar chart</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title=</span><span class="st">"Average Yearly Temperature (°C)"</span>), </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Setting up secondary axis</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">side=</span><span class="st">"right"</span>,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title=</span><span class="st">"Average Yearly Rainfall (mm)"</span>,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">automargin=</span><span class="cn">TRUE</span>),</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Formatting legend</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">orientation=</span><span class="st">'h'</span>, <span class="co"># Orientating legend</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y=</span><span class="sc">-</span><span class="fl">0.2</span>))   <span class="co"># Positioning legend to bottom of plot</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-da528c00903ad5ad4d6a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-da528c00903ad5ad4d6a">{"x":{"visdat":{"fab471f64cf8":["function () ","plotlyVisDat"]},"cur_data":"fab471f64cf8","attrs":{"fab471f64cf8":{"x":{},"y":{},"mode":"lines+markers","marker":{"color":"#008000","size":5,"line":{"color":"#008000","width":1.5}},"line":{"color":"#008000","width":1.5},"yaxis":"y","name":"Mean Temperature","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"fab471f64cf8.1":{"x":{},"y":{},"mode":"lines+markers","marker":{"color":"#8B0000","size":5,"line":{"color":"#8B0000","width":1.5}},"line":{"color":"#8B0000","width":1.5},"yaxis":"y","name":"Maximum Temperature","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"fab471f64cf8.2":{"x":{},"y":{},"mode":"lines+markers","marker":{"color":"#02367B","size":5,"line":{"color":"#02367B","width":1.5}},"line":{"color":"#02367B","width":1.5},"yaxis":"y","name":"Minimum Temperature","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"fab471f64cf8.3":{"x":{},"y":{},"mode":"lines+markers","marker":{"color":"lightblue","size":5,"line":{"color":"black","width":1}},"line":{"color":"#008000","width":1.5},"yaxis":"y2","name":"Total Daily Rainfall","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average Yearly Temperature and Rainfall Over the Years","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","tickmode":"linear"},"yaxis":{"domain":[0,1],"automargin":true,"overlaying":"y2","title":"Average Yearly Temperature (°C)"},"yaxis2":{"side":"right","title":"Average Yearly Rainfall (mm)","automargin":true},"legend":{"orientation":"h","y":-0.20000000000000001},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2014,2015,2016,2017,2018,2019,2020,2021,2022,2023],"y":[27.898133099055567,28.12364071335363,28.379687140556705,27.888187018154689,27.860127416520211,28.349898671470388,28.051211705532694,27.88871109162648,27.820021905805039,28.04231934227607],"mode":"lines+markers","marker":{"color":"#008000","size":5,"line":{"color":"#008000","width":1.5}},"line":{"color":"#008000","width":1.5},"yaxis":"y","name":"Mean Temperature","type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","frame":null},{"x":[2014,2015,2016,2017,2018,2019,2020,2021,2022,2023],"y":[31.44976938282451,31.69088734232275,31.863699102829539,31.311211887590151,31.504964850615114,32.040779103805448,31.707201646090535,31.565344147303815,31.530142387732749,31.790263954997837],"mode":"lines+markers","marker":{"color":"#8B0000","size":5,"line":{"color":"#8B0000","width":1.5}},"line":{"color":"#8B0000","width":1.5},"yaxis":"y","name":"Maximum Temperature","type":"scatter","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","frame":null},{"x":[2014,2015,2016,2017,2018,2019,2020,2021,2022,2023],"y":[25.341906435317373,25.709482383645064,25.749942489072925,25.439766227306642,25.359885764499122,25.910110335510023,25.50029721079104,25.27555896536607,25.150383351588172,25.554175681523148],"mode":"lines+markers","marker":{"color":"#02367B","size":5,"line":{"color":"#02367B","width":1.5}},"line":{"color":"#02367B","width":1.5},"yaxis":"y","name":"Minimum Temperature","type":"scatter","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","frame":null},{"x":[2014,2015,2016,2017,2018,2019,2020,2021,2022,2023],"y":[5.3237425873050688,4.6746846454980426,5.8116402116402135,6.6254663019149458,6.2760984182776776,4.4845530285971611,6.5610196616369496,7.9480929416922317,7.3215115005476417,7.4617697966248429],"mode":"lines+markers","marker":{"color":"lightblue","size":5,"line":{"color":"black","width":1}},"line":{"color":"#008000","width":1.5},"yaxis":"y2","name":"Total Daily Rainfall","type":"bar","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="geographical-overview-of-historical-daily-weather-data" class="level3">
<h3 class="anchored" data-anchor-id="geographical-overview-of-historical-daily-weather-data">4.2 Geographical Overview of Historical Daily Weather Data</h3>
<p>In this section, we will be developing the prototype for a geographical overview of the historical daily weather data.</p>
<p>The geospatial data of the geographical boundary of Singapore at the planning subzone level is provided by <a href="#0">data.gov.sg</a>.</p>
<div class="cell">
<details>
<summary>Code to process data for plotting</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing geospatial data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"Data/geospatial"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"MP14_SUBZONE_WEB_PL"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting relevant columns</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">9</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Aggregating data using yearly intervals</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station, Year) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rainfall =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Total Daily Rainfall</span><span class="st">`</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_temp =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Mean Temperature</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining attribute data and geospatial data</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Station =</span> <span class="fu">toupper</span>(Station)) <span class="co"># Converting to uppercase</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Join based on SUBZONE_N = Station</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>mpsz_df2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(mpsz, df2, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">by=</span><span class="fu">c</span>(<span class="st">"PLN_AREA_N"</span><span class="ot">=</span><span class="st">"Station"</span> )) </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mpsz_df2, <span class="st">"Data/mpsz_ds2.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Temperature</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Rainfall</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code for plotting static map for temperature</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mpsz_df2 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"Data/mpsz_ds2.rds"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Activating viewing mode</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting data by geography</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>map_static_temp <span class="ot">&lt;-</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mpsz_df2) <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adding data points onto map</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"mean_temp"</span>, </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">style=</span><span class="st">"pretty"</span>, <span class="co"># Display many colours over continuous palette</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette=</span><span class="st">"YlOrRd"</span>, <span class="co"># Using yellow, orange, red palette for temperature data</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Mean Temperature (°C)"</span>) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Labelling plot</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Mean Temperature by Planning Area"</span>, </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.position=</span><span class="st">"center"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size=</span><span class="fl">1.2</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.height=</span><span class="fl">0.65</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.width=</span><span class="fl">0.35</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.position=</span><span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">frame=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adding caption to cite sources</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_credits</span>(<span class="st">"Source: Planning Area Boundary from Urban Redevelopment Authority and Weather Data from Meteological Service Singapore"</span>, </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">position=</span><span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code for plotting animated map for temperature</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Activating viewing mode</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>map_static_temp <span class="ot">&lt;-</span> map_static_temp <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting by year</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by=</span><span class="st">"Year"</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">free.coords=</span><span class="cn">FALSE</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">drop.NA.facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># Drop facets with Year = NA </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding grey polygons for NA values - needed to standardise map across all years</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mpsz_df2[<span class="fu">is.na</span>(mpsz_df2<span class="sc">$</span>mean_temp), ]) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">fill =</span> <span class="st">"grey"</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting animated map</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_animation</span>(map_static_temp, <span class="at">delay=</span><span class="dv">75</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">filename=</span><span class="st">"map_temp.gif"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="map_temp.gif" class="img-fluid"></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code for plotting static map for rainfall</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Activating viewing mode</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting data by geography</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>map_static_rainfall <span class="ot">&lt;-</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mpsz_df2) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adding data points onto map</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"mean_rainfall"</span>, </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">style=</span><span class="st">"pretty"</span>, <span class="co"># Display many colours over continuous palette</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette=</span><span class="st">"Blues"</span>, <span class="co"># Using blue palette for temperature data</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Rainfall (mm)"</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Labelling plot</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Mean Total Daily Rainfall by Planning Area"</span>, </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.position=</span><span class="st">"center"</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size=</span><span class="fl">1.2</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.height=</span><span class="fl">0.65</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.width=</span><span class="fl">0.35</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.position=</span><span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">frame=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adding caption to cite sources</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_credits</span>(<span class="st">"Source: Planning Area Boundary from Urban Redevelopment Authority and Weather Data from Meteological Service Singapore"</span>, </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">position=</span><span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code for plotting animated map for rainfall</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Activating viewing mode</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>map_static_rainfall <span class="ot">&lt;-</span> map_static_rainfall <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting by year</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by=</span><span class="st">"Year"</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">free.coords=</span><span class="cn">FALSE</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">drop.NA.facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># Drop facets with Year = NA </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding grey polygons for NA values - needed to standardise map across all years</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mpsz_df2[<span class="fu">is.na</span>(mpsz_df2<span class="sc">$</span>mean_temp), ]) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">fill =</span> <span class="st">"grey"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting animated map</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_animation</span>(map_static_rainfall, <span class="at">delay=</span><span class="dv">75</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">filename=</span><span class="st">"map_rainfall.gif"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="map_rainfall.gif" class="img-fluid"></p>
</div>
</div>
</div>
<p>As we only have data for 12 weather stations, the significant portion of grey polygons on the map are due to the missing weather data for the respective weather stations. The data was limited to ensure that the plots could be developed quickly. When the Shiny application is developed, we would expected to have a more complete data of more than 60 weather stations to have a more comprehensive map.</p>
</section>
</section>
<section id="user-interface-ui-design-of-shiny-application" class="level2">
<h2 class="anchored" data-anchor-id="user-interface-ui-design-of-shiny-application">5.0 User-Interface (UI) Design of Shiny Application</h2>
<p>In this module of the application, the user is able to select the weather data from their preferred weather station(s) to analyse and compare the various time series timeline they are interested in. Through this, the user is able to understand the historical trends and average of temperature and/or rainfall data during the selected time period.</p>
<section id="storyboard-of-shiny-application" class="level3">
<h3 class="anchored" data-anchor-id="storyboard-of-shiny-application">5.1 Storyboard of Shiny Application</h3>
<p><img src="images/Screenshot 2024-03-08 at 6.34.06 PM.png" class="img-fluid"></p>
</section>
<section id="user-specified-parameters-of-shiny-application" class="level3">
<h3 class="anchored" data-anchor-id="user-specified-parameters-of-shiny-application">5.2 User-Specified Parameters of Shiny Application</h3>
<p>The figure below shows some of the interactive features of the application. The main objective is to allow users to have an overview of the historical data of their selection weather station(s) and time period.</p>
<p><img src="images/Screenshot 2024-03-08 at 6.35.32 PM.png" class="img-fluid"></p>
<p>The parameters users can specify include the following:</p>
<ul>
<li><p><strong>Averaging Period</strong>: Users can choose the averaging period they prefer, including monthly, 1-year, 5-years or 10-years, using the drop-down list.</p></li>
<li><p><strong>Period for Analysis</strong>: Users can choose the start and end date they prefer, from January 1980 to current using the slider. However, limited data is available from January 1980 to December 2013 and may cause the plots to be incomplete.</p></li>
<li><p><strong>Weather Station(s)</strong>: Users can choose their preferred weather station(s) by checking the checkboxes of weather stations they are interested in. A checkbox for “All weather stations” will be included for convenience.</p></li>
<li><p><strong>Update Data</strong>: Users can choose to update the data to include the most current data points available on the MSS website. The application is built using data up till December 2023. Users may be interested in analysing more current weather data and can include such points using the “Update Data” button to scrape the data from the MSS website.</p></li>
<li><p><strong>Selection of Map Type</strong>: Users can choose to display temperature or rainfall data on the map using the radio buttons available. Users can also choose the type of data to be displayed, such as mean, maximum or minimum, using the drop-down list.</p></li>
<li><p><strong>Selection of Plot</strong>: Users can choose the data points they wish to display on the plot by toggling through the legend of the plot.</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>